import{ap as F,j as e,ao as U,al as Y,r as t,b1 as q,b2 as v,ah as S,n as l,w as G,b6 as J,v as i,aq as w,T as K,aA as c,h as u,aR as Q,aS as X,aT as Z,aU as P,aV as o,aW as ee,ae as m,aE as ae,aj as R,am as se,aY as te,b7 as oe,aK as ne,aL as re,aM as le,aP as ie,b8 as ce,H as de,C as he}from"./index-cVH_xp6I.js";import{D as xe}from"./DialogContentText-Ep2To2m5.js";const je=F(e.jsx("path",{d:"M13 8c0-2.21-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4 4-1.79 4-4m2 2v2h3v3h2v-3h3v-2h-3V7h-2v3zM1 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4"}),"PersonAddAlt1");function pe(){const b=U(),d=Y(),[h,T]=t.useState(""),[n,C]=t.useState(0),[r,A]=t.useState(10),[D,k]=t.useState([]),[x,I]=t.useState(0),[_,j]=t.useState(!1),[E,z]=t.useState(null),B=q.getJson("userData");t.useEffect(()=>{f()},[n,h]);const f=()=>{const a={page_size:r,page_number:n+1,action:"list",search_key:h,org_code:B.organization};v(S.auth.getRolesList,"POST",a).then(s=>{let p=[],g=0;s.data&&Array.isArray(s.data)&&Array.isArray(s.data[0])&&(p=s.data[0],s.data[1]&&typeof s.data[1].rowCount=="number"?g=s.data[1].rowCount:g=p.length),k(p),I(g)}).catch(s=>console.error("Error fetching roles:",s))},L=(a,s)=>C(s),M=a=>{A(parseInt(a.target.value,10)),C(0)},H=a=>{T(a.target.value.toLowerCase())},N=()=>d("/role/create"),O=async()=>{const a={id:E};try{(await v(S.auth.deleteRole,"POST",a)).status&&f()}catch(s){console.error("Error deleting role:",s)}finally{j(!1)}},y=()=>j(!1),V=a=>a.replace(/\b\w/g,s=>s.toUpperCase()),W=[e.jsx(ce,{underline:"hover",color:"inherit",to:"/home",children:"Home"},"1"),e.jsx(i,{sx:{color:"text.primary"},children:"Settings"},"2"),e.jsx(i,{sx:{color:"text.primary"},children:"Role"},"3")],$=D.map((a,s)=>({...a,s_no:n*r+s+1}));return e.jsxs(l,{sx:{px:3,py:2,minHeight:"100vh"},children:[e.jsx(G,{spacing:1,children:e.jsx(J,{separator:"â€º","aria-label":"breadcrumb",children:W})}),e.jsx(i,{variant:"h4",gutterBottom:!0,children:"Role"}),e.jsx(w,{sx:{boxShadow:3,p:1,mb:2},children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(K,{label:"Search role name",size:"small",variant:"outlined",value:h,onChange:H,sx:{width:"30%"}}),e.jsx(c,{title:"Create new role",children:e.jsx(u,{variant:"contained",sx:{backgroundColor:b.palette.primary.main,"&:hover":{backgroundColor:b.palette.primary.dark}},onClick:N,startIcon:e.jsx(je,{}),children:"Add Role"})})]})}),e.jsxs(w,{sx:{boxShadow:3},children:[e.jsx(Q,{children:e.jsxs(X,{size:"small",children:[e.jsx(Z,{children:e.jsxs(P,{children:[e.jsx(o,{children:"S.No"}),e.jsx(o,{children:"Role"}),e.jsx(o,{children:"Description"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ee,{children:$.map(a=>e.jsxs(P,{children:[e.jsx(o,{children:a.s_no}),e.jsx(o,{children:V(a.role_name)}),e.jsx(o,{children:a.description||"--"}),e.jsxs(o,{children:[e.jsx(c,{title:"Edit Role",children:e.jsx(m,{color:"primary",onClick:()=>d(R.role.edit(a.role_id)),children:e.jsx(ae,{})})}),e.jsx(c,{color:"info",title:"View Role",children:e.jsx(m,{onClick:()=>d(R.role.details(a.role_id)),children:e.jsx(se,{})})}),e.jsx(c,{title:"Delete Role",children:e.jsx(m,{color:"error",onClick:()=>{j(!0),z(a.role_id)},children:e.jsx(te,{})})})]})]},a.id))})]})}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,sx:{flexWrap:"wrap",gap:1},children:[e.jsx(i,{variant:"body2",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flex:1},children:`Showing data ${n*r+1} to ${Math.min((n+1)*r,x)} of ${x}`}),e.jsx(l,{sx:{flexShrink:0},children:e.jsx(oe,{component:"div",count:x,page:n,onPageChange:L,rowsPerPage:r,onRowsPerPageChange:M,rowsPerPageOptions:[10,20,30,40]})})]})]}),e.jsxs(ne,{open:_,onClose:y,children:[e.jsx(re,{children:"Are you sure you want to delete this role?"}),e.jsx(le,{children:e.jsx(xe,{children:"This action cannot be undone. The role data will be permanently removed."})}),e.jsxs(ie,{children:[e.jsx(u,{onClick:O,color:"error",variant:"contained",children:"Yes, confirm"}),e.jsx(u,{onClick:y,children:"No, cancel"})]})]})]})}const ge={title:`Role - ${he.site.name}`};function be(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsxs("title",{children:[" ",ge.title]})}),e.jsx(pe,{})]})}export{be as default};
