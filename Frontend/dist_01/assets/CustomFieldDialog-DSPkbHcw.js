import{b4 as G,b3 as P,r as v,u as U,_ as O,cQ as B,cR as V,c as j,j as r,s as q,b5 as k,f as M,cC as z,cS as A,b as L,ao as I,a1 as H,b1 as K,aK as Q,aL as Y,aM as $,T as x,U as S,cA as J,cK as Z,v as X,aP as E,h as w,d as ee,aZ as oe,ab as re,b2 as N,ah as D}from"./index-cVH_xp6I.js";import{u as se}from"./formik.esm-63xKD07Q.js";import{a as ie,R as le}from"./Radio-CrP7E0ac.js";function ne(l){return G("MuiFormGroup",l)}P("MuiFormGroup",["root","row","error"]);const te=["className","row"],ae=l=>{const{classes:i,row:e,error:n}=l;return M({root:["root",e&&"row",n&&"error"]},ne,i)},ue=q("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(l,i)=>{const{ownerState:e}=l;return[i.root,e.row&&i.row]}})(({ownerState:l})=>j({display:"flex",flexDirection:"column",flexWrap:"wrap"},l.row&&{flexDirection:"row"})),ce=v.forwardRef(function(i,e){const n=U({props:i,name:"MuiFormGroup"}),{className:m,row:f=!1}=n,h=O(n,te),c=B(),t=V({props:n,muiFormControl:c,states:["error"]}),o=j({},n,{row:f,error:t.error}),g=ae(o);return r.jsx(ue,j({className:k(g.root,m),ownerState:o,ref:e},h))});function de(l){return G("MuiRadioGroup",l)}P("MuiRadioGroup",["root","row","error"]);const pe=["actions","children","className","defaultValue","name","onChange","value"],me=l=>{const{classes:i,row:e,error:n}=l;return M({root:["root",e&&"row",n&&"error"]},de,i)},fe=v.forwardRef(function(i,e){const{actions:n,children:m,className:f,defaultValue:h,name:c,onChange:t,value:o}=i,g=O(i,pe),s=v.useRef(null),_=me(i),[C,p]=z({controlled:o,default:h,name:"RadioGroup"});v.useImperativeHandle(n,()=>({focus:()=>{let u=s.current.querySelector("input:not(:disabled):checked");u||(u=s.current.querySelector("input:not(:disabled)")),u&&u.focus()}}),[]);const y=A(e,s),b=L(c),a=v.useMemo(()=>({name:b,onChange(u){p(u.target.value),t&&t(u,u.target.value)},value:C}),[b,t,p,C]);return r.jsx(ie.Provider,{value:a,children:r.jsx(ce,j({role:"radiogroup",ref:y,className:k(_.root,f)},g,{children:m}))})}),he=["Disputes","Orders","Payments","Quota"],ge=["Text","Number","Date","Select","Textarea","Boolean"],xe=[{label:"Yes or No",value:"1"},{label:"True or False",value:"2"},{label:"On or Off",value:"3"}],ve={Select:"character_varying",Number:"double_precision",Text:"character_varying",Date:"timestamp_without_time_zone",Textarea:"text",Boolean:"boolean"},ye={1:["Yes","No"],2:["True","False"],3:["On","Off"]};function _e({open:l,onClose:i,data:e,onSubmitCustom:n,slug:m}){var g;const f=I();H();const h=K.getJson("userData"),[c,t]=v.useState({open:!1,message:"",severity:"success"}),o=se({initialValues:{field_type:(e==null?void 0:e.field_type)||"",fieldName:(e==null?void 0:e.field_name)||"",description:(e==null?void 0:e.field_description)||"",fieldType:(e==null?void 0:e.field_element)||"",placeholder:(e==null?void 0:e.field_placeholder)||"",options:((g=e==null?void 0:e.field_option)==null?void 0:g.join(", "))||"",optionRadios:(e==null?void 0:e.optionRadios)||"1"},enableReinitialize:!0,onSubmit:async(s,{setSubmitting:_,resetForm:C,setErrors:p})=>{const{field_type:y,fieldName:b,fieldType:a,placeholder:u,description:W,options:F,optionRadios:T}=s;if(!y||y==="Select"){p({field_type:"Please choose a field type"});return}if(!b){p({fieldName:"Field name is required"});return}if(!a){p({fieldType:"Field type is required"});return}if(a==="Select"&&!F){p({options:"Options are required for Select field"});return}if(a==="Boolean"&&!T){p({optionRadios:"Please select a boolean display option"});return}const R={field_type:y,field_name:b,description:W,element:a==="Boolean"?"Radio":a,data_type:ve[a]||"boolean",placeholder:u,options:a==="Select"?F.split(",").map(d=>d.trim()):a==="Boolean"&&ye[T]||null,is_required:!0,org_code:h.organization,user_id:h.user_id};try{let d;e!=null&&e.id?(R.id=e.id,d=await N(D.external_api.updateNewFields,"POST",R)):d=await N(D.external_api.addNewField,"POST",R),d.status?(t({open:!0,message:d.message||"Operation successful",severity:"success"}),!(e!=null&&e.id)&&m==="data-source"&&n(),C(),i()):t({open:!0,message:d.message||"Operation failed",severity:"error"})}catch(d){t({open:!0,message:d.message||"Something went wrong",severity:"error"})}finally{_(!1)}}});return r.jsxs(r.Fragment,{children:[r.jsx(Q,{open:l,onClose:i,maxWidth:"sm",fullWidth:!0,children:r.jsxs("form",{onSubmit:o.handleSubmit,children:[r.jsx(Y,{children:e!=null&&e.id?"Edit Custom Field":"Add Custom Field"}),r.jsxs($,{children:[r.jsx(x,{margin:"dense",label:"Destination",name:"field_type",select:!0,fullWidth:!0,variant:"outlined",value:o.values.field_type,onChange:o.handleChange,error:!!o.errors.field_type,helperText:o.errors.field_type,children:he.map(s=>r.jsx(S,{value:s,children:s},s))}),r.jsx(x,{margin:"dense",label:"Field Name",name:"fieldName",fullWidth:!0,variant:"outlined",value:o.values.fieldName,onChange:o.handleChange,error:!!o.errors.fieldName,helperText:o.errors.fieldName}),r.jsx(x,{margin:"dense",label:"Description",name:"description",fullWidth:!0,multiline:!0,rows:2,variant:"outlined",value:o.values.description,onChange:o.handleChange}),r.jsx(x,{margin:"dense",label:"Field Type",name:"fieldType",select:!0,fullWidth:!0,disabled:!!(e!=null&&e.id),variant:"outlined",value:o.values.fieldType,onChange:o.handleChange,error:!!o.errors.fieldType,helperText:o.errors.fieldType,children:ge.map(s=>r.jsx(S,{value:s,children:s},s))}),o.values.fieldType==="Select"&&r.jsx(x,{margin:"dense",label:"Options (comma separated)",name:"options",fullWidth:!0,variant:"outlined",value:o.values.options,onChange:o.handleChange,error:!!o.errors.options,helperText:o.errors.options}),o.values.fieldType==="Boolean"&&r.jsxs(r.Fragment,{children:[r.jsx(J,{component:"legend",sx:{mt:2},children:"Valid Value Pair Display"}),r.jsx(fe,{name:"optionRadios",value:o.values.optionRadios,onChange:o.handleChange,row:!0,children:xe.map(s=>r.jsx(Z,{value:s.value,control:r.jsx(le,{}),label:s.label,disabled:!!(e!=null&&e.id)},s.value))}),o.errors.optionRadios&&r.jsx(X,{color:"error",variant:"caption",children:o.errors.optionRadios})]}),r.jsx(x,{margin:"dense",label:"Placeholder",name:"placeholder",fullWidth:!0,variant:"outlined",value:o.values.placeholder,onChange:o.handleChange})]}),r.jsxs(E,{children:[r.jsx(w,{type:"submit",variant:"contained",sx:{backgroundColor:f.palette.primary.main,"&:hover":{backgroundColor:f.palette.primary.dark}},disabled:o.isSubmitting,children:o.isSubmitting?r.jsx(ee,{size:24}):e!=null&&e.id?"Update Field":"Add Field"}),r.jsx(w,{onClick:i,disabled:o.isSubmitting,children:"Cancel"})]})]})}),r.jsx(oe,{open:c.open,autoHideDuration:3e3,onClose:()=>t({...c,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:r.jsx(re,{onClose:()=>t({...c,open:!1}),severity:c.severity,sx:{width:"100%"},children:c.message})})]})}export{_e as C};
