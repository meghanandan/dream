import{r as n,b1 as E,j as t,cY as N,bB as d,cZ as b,c_ as _,c$ as c,b8 as P,cN as F,cn as m,ct as T,cv as i,b2 as h,ah as p,H as U,C as H}from"./index-cVH_xp6I.js";const{Option:L}=_;function A(){const[x,g]=n.useState([]),[u,j]=n.useState([]),[S,r]=n.useState(!1),[w,k]=n.useState(""),v=E.getJson("userData"),{organization:f,user_id:y}=v;n.useEffect(()=>{(async()=>{try{await Promise.all([C(),D()])}catch{i.error("Error fetching data. Please try again.")}})()},[]);const D=async()=>{const a={org_code:f,user_id:y};try{const e=await h(p.external_api.getFieldsMappingInfoList,"POST",a);e.status?g(e.data):i.warning("No data found.")}catch{i.error("Error fetching orders. Please try again.")}},C=async()=>{const a={name:"table_types"};try{const e=await h(p.external_api.dropDownApi,"POST",a);e.status?j(e.data):i.warning("No dropdown data found.")}catch{i.error("Error fetching dropdown. Please try again.")}},l=(a,e,s)=>{g(M=>M.map(o=>o.id===a?{...o,[e]:s}:o))},I=async()=>{const a={org_code:f,user_id:y,fields:x.map(e=>({...e,destination_type:Number(e.destination_type)}))};try{const e=await h(p.external_api.updateFieldsMappingInfo,"POST",a);e.status?(k(e.message),r(!0)):i.error("Update failed.")}catch{i.error("Error submitting data. Please try again.")}},O=n.useMemo(()=>[{title:"Field Name",dataIndex:"field_name",key:"field_name"},{title:t.jsx(d,{title:"Label to display for this field",children:"Field Label"}),dataIndex:"field_label",key:"field_label",render:(a,e)=>t.jsx(N,{value:a,onChange:s=>l(e.id,"field_label",s.target.value)})},{title:t.jsx(d,{title:"Allow editing this field",children:"Editable"}),dataIndex:"is_editable",key:"is_editable",render:(a,e)=>t.jsx(b,{checked:e.is_editable,onChange:s=>l(e.id,"is_editable",s.target.checked)})},{title:t.jsx(d,{title:"Should this field be visible",children:"Visible"}),dataIndex:"is_visible",key:"is_visible",render:(a,e)=>t.jsx(b,{checked:e.is_visible,onChange:s=>l(e.id,"is_visible",s.target.checked)})},{title:t.jsx(d,{title:"Where to send this field",children:"Destination Type"}),dataIndex:"destination_type",key:"destination_type",render:(a,e)=>t.jsx(_,{value:String(e.destination_type??""),style:{width:"100%"},onChange:s=>l(e.id,"destination_type",s),children:u.map(s=>t.jsx(L,{value:s.id,children:s.name},s.id))})}],[u]);return t.jsxs("div",{style:{padding:15,minHeight:"100vh"},children:[t.jsxs(c,{children:[t.jsx(c.Item,{children:t.jsx(P,{to:"/home",children:"Home"})}),t.jsx(c.Item,{children:"Set Up"})]}),t.jsx("h2",{style:{margin:"0.5rem 0"},children:"Set Up"}),t.jsxs("div",{style:{background:"#fff",padding:2,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(F,{dataSource:x,columns:O,rowKey:"id",pagination:!1,scroll:{x:"max-content"},rowClassName:(a,e)=>e%2===0?"table-row-white":"table-row-gray"}),t.jsx(m,{className:"orange-button",onClick:I,style:{margin:"0.75rem"},children:"Submit"})]}),t.jsx(T,{title:"Success",visible:S,onOk:()=>r(!1),onCancel:()=>r(!1),footer:[t.jsx(m,{type:"primary",onClick:()=>r(!1),children:"OK"},"ok")],children:w})]})}const B={title:`Set Up - ${H.site.name}`};function $(){return t.jsxs(t.Fragment,{children:[t.jsx(U,{children:t.jsxs("title",{children:[" ",B.title]})}),t.jsx(A,{})]})}export{$ as default};
