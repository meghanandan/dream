import{K as x,ao as H,al as he,r as n,b1 as G,b2 as O,ah as I,j as e,aK as me,aL as xe,aM as ge,v as w,ar as f,T as k,bg as be,aG as je,aH as fe,aI as ve,aP as ye,h as B,Z as M,n as _,w as Se,b6 as De,aq as $,aR as Pe,aS as Ce,aT as Te,aU as L,aV as N,aW as _e,ae as we,b7 as ke,P as Oe,ax as Ie,ay as Ae,cX as Re,V as qe,b8 as We,H as Ye,C as Me}from"./index-cVH_xp6I.js";import{T as Ee}from"./TouchApp-9PRo3SF3.js";import{c as J,b as Fe,a as A}from"./index.esm-DW-FEPUt.js";import{D as ze}from"./index-DPZk-k-v.js";J().shape({orderId:A().required("Order ID is required"),disputeReason:A().required("Dispute reason is required"),disputeAmount:Fe().typeError("Dispute amount must be a number").positive("Amount must be positive").required("Dispute amount is required")});x.bool.isRequired,x.func.isRequired,x.func.isRequired,x.shape({orderId:x.string,disputeReason:x.string,disputeAmount:x.number});J().shape({disputeType:A().required("Select dispute type"),disputeTemplate:A().required("Select dispute template")});const Be=({open:R,onClose:g,workFlowId:d,templateId:c,orderId:i,templateType:E})=>{const y=H(),S=he(),[u,m]=n.useState([]),[D,v]=n.useState([]),[P,C]=n.useState(null),p=G.getJson("userData");n.useEffect(()=>{i&&c&&q()},[i,c]);const q=async()=>{try{const t={order_id:i,template_id:c,org_code:p.organization},s=await O(I.auth.raiseDispute,"POST",t);s!=null&&s.data?(m(s.data.fields),v(s.data.fields)):(m([]),console.warn("No dispute templates found."))}catch(t){console.error("Error fetching dispute templates:",t)}};function W(t,s){const r=s.find(l=>l.id===4);return console.log(r),r}const Y=async()=>{const t=u,s=W(t,D);s.is_negative=!0,s.visible=!1,t.push(s);const r={org_code:p.organization,work_flow_id:d,template_id:c,template_type:2,created_by:p.user_id,fields:t};(await O(I.auth.createDispute,"POST",r)).status?(C({severity:"succes",message:""}),c===1?(S("/disputes"),m([]),v([]),g()):(S("/disputes"),m([]),v([]),g())):C({severity:"error",message:"Role Name already exists."})},h=(t,s)=>{const r=u.map(l=>l.name===t.name?l.element==="date"?{...l,value:s?M(s).format("YYYY-MM-DD"):"",is_negative:!1}:(!l.disable&&l.field_id,{...l,value:s,is_negative:!1}):l);m(r)};return e.jsxs(me,{open:R,fullWidth:!0,maxWidth:"md",children:[e.jsx(xe,{children:"Sales Commission Dispute Form"}),e.jsxs(ge,{dividers:!0,children:[e.jsx(w,{variant:"body1",sx:{mb:2},children:"Please review the pre-filled information and complete the dispute details."}),e.jsx(f,{container:!0,spacing:2,children:u&&u.map((t,s)=>t.element==="input"&&t.visible?e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(k,{fullWidth:!0,label:t.label,value:t.value,onChange:r=>h(t,r.target.value),disabled:t.disable})},s):t.element==="text"&&t.visible?e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(k,{fullWidth:!0,label:t.label,value:t.value,onChange:r=>h(t,r.target.value),disabled:t.disable})},s):t.element==="number"&&t.visible?e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(k,{fullWidth:!0,label:t.label,value:t.value,onChange:r=>h(t,r.target.value),disabled:t.disable})},s):t.element==="date"&&t.visible?e.jsx(f,{item:!0,xs:12,md:4,children:e.jsx(be,{label:t.label,onChange:r=>h(t,r)})},s):e.jsx(f,{item:!0,xs:12,md:4,children:e.jsxs(je,{fullWidth:!0,children:[e.jsx(fe,{id:"demo-simple-select-label",children:t.label}),e.jsx(ve,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t.value,onChange:r=>h(t,r.target.value)})]})},s))})]}),e.jsxs(ye,{sx:{p:2},children:[e.jsx(B,{onClick:Y,variant:"contained",sx:{backgroundColor:y.palette.primary.main,"&:hover":{backgroundColor:y.palette.primary.dark}},children:"Create"}),e.jsx(B,{onClick:g,variant:"outlined",color:"secondary",children:"Cancel"})]})]})};function $e(){const{RangePicker:R}=ze;H();const g=G.getJson("userData"),[d,c]=n.useState(1),[i,E]=n.useState(10),[y,S]=n.useState([]),[u,m]=n.useState(0),[D,v]=n.useState([]),[P,C]=n.useState(""),[p,q]=n.useState([M().startOf("month"),M().endOf("month")]),[W,Y]=n.useState([]),[h,t]=n.useState(null),[s,r]=n.useState(""),[l,F]=n.useState(!1),[K,V]=n.useState(""),[U,X]=n.useState(""),[Z,Q]=n.useState("");n.useEffect(()=>{ee(),te()},[P,p,d,i]);const ee=()=>{var o,b;const a={type:"2",org_code:g.organization,user_id:g.user_id,search_key:P,from:(o=p[0])==null?void 0:o.format("YYYY-MM-DD"),to:(b=p[1])==null?void 0:b.format("YYYY-MM-DD"),page_size:i,page_number:d};O(I.external_api.getOrdersData,"POST",a).then(j=>{if(j.status){const de=j.rows.map((T,pe)=>({...T,s_no:(d-1)*i+pe+1}));S(de),m(j.count);const ce=j.headers.map(T=>({key:T.key,label:T.label})),ue=[{key:"s_no",label:"S.No"},...ce,{key:"action",label:"Action"}];v(ue)}}).catch(j=>console.error("Error fetching orders:",j))},te=()=>{O(I.auth.getDisputeorAdjustmentDropDown,"POST",{search_key:"",type:null}).then(a=>{a.data.length>0&&Y(a.data)}).catch(a=>console.error("Error fetching dispute adjustments:",a))},ae=(a,o)=>{r(o),t(a.currentTarget)},z=()=>t(null),se=(a,o,b)=>{X(a),V(o),Q(b),F(!0),z()},ne=a=>q(a),re=a=>C(a.target.value),oe=(a,o)=>c(o+1),le=a=>{E(parseInt(a.target.value,10)),c(1)},ie=[e.jsx(We,{underline:"hover",color:"inherit",to:"/home",children:"Home"},"1"),e.jsx(w,{sx:{color:"text.primary"},children:"Payments"},"3")];return e.jsxs(_,{sx:{px:3,py:2},children:[e.jsx(Se,{spacing:1,children:e.jsx(De,{separator:"â€º","aria-label":"breadcrumb",children:ie})}),e.jsx(w,{variant:"h4",gutterBottom:!0,children:"Payments"}),e.jsx($,{sx:{boxShadow:3,p:1,mb:1},children:e.jsxs(_,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2,children:[e.jsx(k,{label:"Search",size:"small",variant:"outlined",value:P,onChange:re,sx:{width:"30%"}}),e.jsx(R,{value:p,onChange:ne})]})}),e.jsxs($,{sx:{boxShadow:3},children:[e.jsx(Pe,{children:e.jsxs(Ce,{size:"small",children:[e.jsx(Te,{children:e.jsx(L,{children:D.map(a=>e.jsx(N,{sx:{fontWeight:"bold",backgroundColor:"#f5f5f5"},children:a.label},a.key))})}),e.jsx(_e,{children:y.map(a=>e.jsx(L,{children:D.map(o=>e.jsx(N,{children:o.key==="action"?e.jsx(we,{onClick:b=>ae(b,a.prod_orders_row_id),children:e.jsx(Ee,{})}):a[o.key]!==null&&a[o.key]!==void 0?a[o.key]:"-"},o.key))},a.prod_orders_row_id))})]})}),e.jsxs(_,{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,sx:{flexWrap:"wrap",gap:1},children:[e.jsx(w,{variant:"body2",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flex:1},children:`Showing data ${(d-1)*i+1} to ${Math.min(d*i,u)} of ${u}`}),e.jsx(_,{sx:{flexShrink:0},children:e.jsx(ke,{component:"div",count:u,page:d-1,onPageChange:oe,rowsPerPage:i,onRowsPerPageChange:le,rowsPerPageOptions:[10,20,30,40]})})]})]}),e.jsx(Oe,{open:!!h,anchorEl:h,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ie,{children:W.map(a=>e.jsx(Ae,{disablePadding:!0,children:e.jsx(Re,{onClick:()=>se(a.id,a.work_flow_id,a.template_type),dense:!0,children:e.jsx(qe,{primary:a.name})})},a.id))})}),e.jsx(Be,{open:l,workFlowId:K,templateId:U,orderId:s,onClose:()=>F(!1),templateType:Z})]})}const Le={title:`Payments - ${Me.site.name}`};function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:e.jsxs("title",{children:[" ",Le.title]})}),e.jsx($e,{})]})}export{Ke as default};
