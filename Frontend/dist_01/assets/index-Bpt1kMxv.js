import{bc as W,r as i,R as rt,bd as ut,be as ht,bf as xt,b1 as mt,b2 as p,ah as g,j as t,aq as v,bg as V,Z as N,aG as P,aH as O,aI as I,U as f,h as X,n as R,w as pt,b6 as gt,v as c,d as jt,ar as h,a9 as D,aa as C,b8 as ft,bh as yt,bi as bt,bj as vt,bk as Dt,bl as Ct,bm as Ft,bn as Bt,bo as St,H as At,C as Tt}from"./index-cVH_xp6I.js";const lt="label";function tt(s,n){typeof s=="function"?s(n):s&&(s.current=n)}function Et(s,n){const r=s.options;r&&n&&Object.assign(r,n)}function it(s,n){s.labels=n}function ot(s,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lt;const u=[];s.datasets=n.map(d=>{const x=s.datasets.find(F=>F[r]===d[r]);return!x||!d.data||u.includes(x)?{...d}:(u.push(x),Object.assign(x,d),x)})}function Pt(s){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lt;const r={labels:[],datasets:[]};return it(r,s.labels),ot(r,s.datasets,n),r}function Ot(s,n){const{height:r=150,width:u=300,redraw:d=!1,datasetIdKey:x,type:F,data:m,options:j,plugins:T=[],fallbackContent:M,updateMode:E,...Y}=s,A=i.useRef(null),o=i.useRef(null),y=()=>{A.current&&(o.current=new W(A.current,{type:F,data:Pt(m,x),options:j&&{...j},plugins:T}),tt(n,o.current))},b=()=>{tt(n,null),o.current&&(o.current.destroy(),o.current=null)};return i.useEffect(()=>{!d&&o.current&&j&&Et(o.current,j)},[d,j]),i.useEffect(()=>{!d&&o.current&&it(o.current.config.data,m.labels)},[d,m.labels]),i.useEffect(()=>{!d&&o.current&&m.datasets&&ot(o.current.config.data,m.datasets,x)},[d,m.datasets]),i.useEffect(()=>{o.current&&(d?(b(),setTimeout(y)):o.current.update(E))},[d,j,m.labels,m.datasets,E]),i.useEffect(()=>{o.current&&(b(),setTimeout(y))},[F]),i.useEffect(()=>(y(),()=>b()),[]),rt.createElement("canvas",{ref:A,role:"img",height:r,width:u,...Y},M)}const It=i.forwardRef(Ot);function H(s,n){return W.register(n),i.forwardRef((r,u)=>rt.createElement(It,{...r,ref:u,type:s}))}const et=H("line",ht),at=H("bar",ut),st=H("doughnut",xt);W.register(yt,bt,vt,Dt,Ct,Ft,Bt,St);const Mt=s=>["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#C9CBCF","#84FF63","#634AFF","#4AFFC7","#FF7F7F","#FFD966","#A9D18E","#6FA8DC"].slice(0,s),nt=()=>{const s=N();return{from:s.startOf("month").format("YYYY-MM-DD"),to:s.format("YYYY-MM-DD"),status:"",type:"",priority:"",user_id:""}};function Yt(){const n=(mt.getJson("userData")||{}).organization||"",[r,u]=i.useState(nt()),[d,x]=i.useState(!0),[F,m]=i.useState({}),[j,T]=i.useState([]),[M,E]=i.useState([]),[Y,A]=i.useState([]),o=[{value:"High",label:"High"},{value:"Medium",label:"Medium"},{value:"Low",label:"Low"}];i.useEffect(()=>{p(g.auth.getUsers,"POST",{org_code:n}).then(e=>{T(((e==null?void 0:e.data)??[]).map(a=>({value:a.emp_id,label:[a.first_name,a.last_name].filter(Boolean).join(" ").trim()})))}),p(g.auth.getDisputesByType,"POST",{org_code:n}).then(e=>{var a;E(((a=e==null?void 0:e.data)==null?void 0:a.map(l=>({value:l.label,label:l.label})))||[])}),p(g.auth.getDisputesByStatus,"POST",{org_code:n}).then(e=>{var a;A(((a=e==null?void 0:e.data)==null?void 0:a.map(l=>({value:l.label,label:l.label})))||[])}),p(g.auth.getUsers,"POST",{org_code:n}).then(e=>{T(((e==null?void 0:e.data)??[]).map(a=>({value:a.emp_id,label:[a.first_name,a.last_name].filter(Boolean).join(" ").trim()})))})},[n]);const y=i.useCallback(()=>{x(!0);const e={org_code:n,...r};Promise.all([p(g.auth.getDisputesByType,"POST",e),p(g.auth.getDisputesByStatus,"POST",e),p(g.auth.getDisputesByMonth,"POST",e),p(g.auth.getDisputesByEscalation,"POST",e),p(g.auth.getAvgResolutionTimeByMonth,"POST",e),p(g.auth.getDisputesSummary,"POST",e),p(g.auth.getDisputesByLicenceType,"POST",e)]).then(([a,l,_,L,w,k,z])=>{m({typeData:(a==null?void 0:a.data)??[],statusData:(l==null?void 0:l.data)??[],monthData:(_==null?void 0:_.data)??[],escalationData:(L==null?void 0:L.data)??[],resolutionData:(w==null?void 0:w.data)??[],summary:(k==null?void 0:k.data)??{},licenceTypeData:(z==null?void 0:z.data)??[]})}).catch(()=>m({})).finally(()=>x(!1))},[n,r]);i.useEffect(()=>{y()},[y]);const b=(e,a="Count")=>({labels:e.map(l=>l.label),datasets:[{label:a,data:e.map(l=>Number(l.value)),backgroundColor:Mt(e.length)}]}),U=(e,a="Count")=>b(e,a),K=(e,a="Avg Days")=>({labels:e.map(l=>l.label),datasets:[{label:a,data:e.map(l=>Number(l.value)),borderColor:"#36A2EB",backgroundColor:"#C9CBCF",fill:!0,tension:.3,pointBackgroundColor:"#36A2EB"}]}),B=(e,a,l="primary")=>t.jsx(D,{sx:{borderLeft:`8px solid var(--mui-palette-${l}-main, #1976d2)`,minWidth:160},children:t.jsxs(C,{children:[t.jsx(c,{variant:"subtitle2",color:"text.secondary",children:e}),t.jsx(c,{variant:"h5",sx:{fontWeight:700},children:a??"--"})]})}),ct=t.jsxs(v,{sx:{mb:2,p:2,display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[t.jsx(V,{label:"From",value:N(r.from),onChange:e=>u(a=>({...a,from:e.format("YYYY-MM-DD")})),slotProps:{textField:{size:"small",sx:{minWidth:140}}}}),t.jsx(V,{label:"To",value:N(r.to),onChange:e=>u(a=>({...a,to:e.format("YYYY-MM-DD")})),slotProps:{textField:{size:"small",sx:{minWidth:140}}}}),t.jsxs(P,{size:"small",sx:{minWidth:140},children:[t.jsx(O,{children:"Status"}),t.jsxs(I,{label:"Status",value:r.status,onChange:e=>u(a=>({...a,status:e.target.value})),children:[t.jsx(f,{value:"",children:"All"}),Y.map(e=>t.jsx(f,{value:e.value,children:e.label},e.value))]})]}),t.jsxs(P,{size:"small",sx:{minWidth:140},children:[t.jsx(O,{children:"Type"}),t.jsxs(I,{label:"Type",value:r.type,onChange:e=>u(a=>({...a,type:e.target.value})),children:[t.jsx(f,{value:"",children:"All"}),M.map(e=>t.jsx(f,{value:e.value,children:e.label},e.value))]})]}),t.jsxs(P,{size:"small",sx:{minWidth:140},children:[t.jsx(O,{children:"Priority"}),t.jsxs(I,{label:"Priority",value:r.priority,onChange:e=>u(a=>({...a,priority:e.target.value})),children:[t.jsx(f,{value:"",children:"All"}),o.map(e=>t.jsx(f,{value:e.value,children:e.label},e.value))]})]}),t.jsxs(P,{size:"small",sx:{minWidth:180},children:[t.jsx(O,{children:"User"}),t.jsxs(I,{label:"User",value:r.user_id,onChange:e=>u(a=>({...a,user_id:e.target.value})),children:[t.jsx(f,{value:"",children:"All"}),j.map(e=>t.jsx(f,{value:e.value,children:e.label},e.value))]})]}),t.jsx(X,{variant:"contained",size:"small",onClick:y,children:"Apply"}),t.jsx(X,{variant:"outlined",size:"small",color:"secondary",onClick:()=>u(nt()),children:"Reset"})]}),dt=[t.jsx(ft,{underline:"hover",color:"inherit",to:"/home",children:"Home"},"1"),t.jsx(c,{color:"text.primary",children:"Analytics"},"2")],{typeData:G=[],statusData:$=[],monthData:q=[],escalationData:J=[],resolutionData:Z=[],summary:S={},licenceTypeData:Q=[]}=F;return t.jsxs(R,{sx:{px:3,py:2,minHeight:"100vh"},children:[t.jsx(pt,{spacing:1,children:t.jsx(gt,{separator:"â€º",children:dt})}),t.jsx(c,{variant:"h4",gutterBottom:!0,sx:{mt:2},children:"Dispute Analytics"}),ct,d?t.jsx(R,{sx:{display:"flex",justifyContent:"center",mt:6},children:t.jsx(jt,{size:50})}):t.jsxs(t.Fragment,{children:[t.jsxs(h,{container:!0,spacing:2,sx:{mb:2},children:[t.jsx(h,{item:!0,xs:6,md:2,children:B("Total Disputes",S.total_disputes,"primary")}),t.jsx(h,{item:!0,xs:6,md:2,children:B("Resolved",S.resolved,"success")}),t.jsx(h,{item:!0,xs:6,md:2,children:B("In Progress",S.in_progress,"info")}),t.jsx(h,{item:!0,xs:6,md:2,children:B("Escalated",S.escalated,"warning")}),t.jsx(h,{item:!0,xs:6,md:2,children:B("Rejected",S.rejected,"error")}),t.jsx(h,{item:!0,xs:6,md:2,children:B("Avg. Resolution (Days)",S.avg_resolution_days,"secondary")})]}),t.jsxs(h,{container:!0,spacing:3,children:[t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Disputes by Type"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:G.length>0?t.jsx(st,{data:b(G,"Disputes"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})}),t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Disputes by Status"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:$.length>0?t.jsx(at,{data:U($,"Disputes"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})}),t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Disputes by Month"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:q.length>0?t.jsx(et,{data:K(q,"Disputes"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})}),t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Disputes by Escalation Level"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:J.length>0?t.jsx(at,{data:U(J,"Disputes"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})}),t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Resolution Time (by Month)"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:Z.length>0?t.jsx(et,{data:K(Z,"Avg Days"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})}),t.jsx(h,{item:!0,xs:12,md:6,children:t.jsx(D,{children:t.jsxs(C,{children:[t.jsx(c,{variant:"h6",gutterBottom:!0,children:"Disputes by License Type"}),t.jsx(v,{sx:{height:280,p:2,display:"flex",alignItems:"center"},children:Q.length>0?t.jsx(st,{data:b(Q,"Disputes"),options:{maintainAspectRatio:!1}}):t.jsx(c,{color:"text.secondary",children:"No data"})})]})})})]})]})]})}const _t={title:`Analytics - ${Tt.site.name}`};function wt(){return t.jsxs(t.Fragment,{children:[t.jsx(At,{children:t.jsxs("title",{children:[" ",_t.title]})}),t.jsx(Yt,{})]})}export{wt as default};
