import{a1 as F,r as N,b1 as C,j as l,aK as R,aL as E,aM as q,T as t,U as P,cA as W,cB as O,n as V,aP as w,h as b,d as k,b2 as z,ah as A}from"./index-cVH_xp6I.js";import{u as L}from"./formik.esm-63xKD07Q.js";import{c as M,a as s}from"./index.esm-DW-FEPUt.js";const U=["Text","Number","Date","Select","Textarea","Boolean"],Y=[{label:"Yes or No",value:"1"},{label:"True or False",value:"2"},{label:"On or Off",value:"3"}],u={Select:"varchar",Number:"double_precision",Text:"varchar",Date:"timestamp_without_time_zone",Textarea:"text",Boolean:"boolean"},$={1:["Yes","No"],2:["True","False"],3:["On","Off"]},G=M({fieldName:s().required("Field name is required"),label:s().required("Label is required"),fieldType:s().required("Field type is required"),placeholder:s().required("Placeholder is required")}),X=({open:v,onClose:n,data:a={},onSave:I})=>{F();const[J,c]=N.useState(null),p=C.getJson("userData"),e=L({enableReinitialize:!0,initialValues:{fieldName:a.field_name||"",fieldType:a.field_element||"",placeholder:a.field_placeholder||"",description:a.field_description||"",options:a.field_option||"",optionRadios:"",id:a.id},validationSchema:G,onSubmit:async(o,{setSubmitting:T,setErrors:B,resetForm:y})=>{var h,m;try{const{fieldName:r,description:j,fieldType:i,placeholder:D,options:f,optionRadios:g,id:S}=o,x={field_name:r,description:j,element:i==="Boolean"?"Radio":i,data_type:(u==null?void 0:u[i])??"boolean",placeholder:D,options:i==="Select"&&f?f.split(",").map(_=>_.trim()):i==="Boolean"&&g&&$[g]||null,is_required:!0,org_code:p.organization,user_id:p.user_id,id:S};console.log("test",x);const d=await z(A.external_api.updateNewFields,"POST",x);d.status?c({severity:"success",message:d.message}):c({severity:"error",message:d.message}),y(),n()}catch(r){console.error("Error while adding cluster:",((m=(h=r==null?void 0:r.response)==null?void 0:h.data)==null?void 0:m.message)||r),B({api:"Failed to update field. Please try again."})}finally{T(!1)}}});return l.jsx(R,{open:v,onClose:n,fullWidth:!0,maxWidth:"sm",children:l.jsxs("form",{onSubmit:e.handleSubmit,noValidate:!0,children:[l.jsx(E,{children:"Edit Field"}),l.jsxs(q,{children:[l.jsx(t,{margin:"dense",label:"Field Name",name:"fieldName",fullWidth:!0,value:e.values.fieldName,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.fieldName&&!!e.errors.fieldName,helperText:e.touched.fieldName&&e.errors.fieldName,placeholder:"Enter the field name"}),l.jsx(t,{margin:"dense",label:"Description",name:"description",fullWidth:!0,multiline:!0,rows:2,variant:"outlined",value:e.values.description,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.description&&!!e.errors.description,helperText:e.touched.description&&e.errors.description,placeholder:"Enter the Description"}),l.jsx(t,{margin:"dense",label:"Field Type",name:"fieldType",select:!0,fullWidth:!0,value:e.values.fieldType,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.fieldType&&!!e.errors.fieldType,helperText:e.touched.fieldType&&e.errors.fieldType,children:U.map(o=>l.jsx(P,{value:o,children:o},o))}),e.values.fieldType==="Select"&&l.jsx(t,{margin:"dense",label:"Options (comma separated)",name:"options",fullWidth:!0,variant:"outlined",value:e.values.options,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.options&&!!e.errors.options,helperText:e.touched.options&&e.errors.options,placeholder:"Enter options separated by commas"}),e.values.fieldType==="Boolean"&&l.jsxs(l.Fragment,{children:[l.jsx(W,{component:"legend",children:"Valid Value Pair Display"}),l.jsx(O.Group,{sx:{mt:2,color:"#FDA92D"},block:!0,options:Y,margin:"dense",label:"Valid Value Pair Display",name:"optionRadios",fullWidth:!0,onChange:e.handleChange,onBlur:e.handleBlur,value:e.values.optionRadios,error:e.touched.optionRadios&&!!e.errors.optionRadios,helperText:e.touched.optionRadios&&e.errors.optionRadios,defaultValue:"1"})]}),l.jsx(t,{margin:"dense",label:"Placeholder",name:"placeholder",fullWidth:!0,value:e.values.placeholder,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.placeholder&&!!e.errors.placeholder,helperText:e.touched.placeholder&&e.errors.placeholder,placeholder:"Enter the placeholder text"}),e.errors.api&&l.jsx(V,{sx:{color:"red",mt:2},children:e.errors.api})]}),l.jsxs(w,{children:[l.jsx(b,{onClick:n,disabled:e.isSubmitting,children:"Cancel"}),l.jsx(b,{type:"submit",variant:"contained",color:"primary",disabled:e.isSubmitting,children:e.isSubmitting?l.jsx(k,{size:24}):"Update"})]})]})})};export{X as E};
